<!DOCTYPE>
<html>
<head>
    <title>一元住酒店</title>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta content="telephone=no" name="format-detection" />
    <!-- UC默认竖屏 ，UC强制全屏 -->
    <meta name="full-screen" content="yes"/>
    <meta name="browsermode" content="application"/>
    <!-- QQ强制竖屏 QQ强制全屏 -->
    <meta name="x5-orientation" content="portrait"/>
    <meta name="x5-fullscreen" content="true"/>
    <meta name="x5-page-mode" content="app"/>
    <meta content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui" name="viewport" />
    <script>

        (function (doc, win) {
            var docEl = doc.documentElement,
                    resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
                    recalc = function () {
                        var clientWidth = docEl.clientWidth;
                        if (!clientWidth) return;
                        docEl.style.fontSize = 20 * (clientWidth / 320) + 'px';
                    };

            if (!doc.addEventListener) return;
            win.addEventListener(resizeEvt, recalc, false);
            doc.addEventListener('DOMContentLoaded', recalc, false);
        })(document, window);
    </script>
    <style type="text/css">

        body{
            margin: 0;
            padding: 0;
            background: #ffd650;
        }
        a {
            color: #000;
            text-decoration: none;
            display: inline-block;
        }
        /*.content{height: 100px}*/
        ul,li{
            list-style: none;
            padding: 0;
            margin: 0;
            overflow: hidden;
            display: inline-block;
        }
        .main{
            font-size:0;
        }
        .img_div{
            position: relative;
            overflow: hidden;
        }
        .img_div img{
            width: 100%;
        }

        .qianghongbao {
            position: fixed;
            z-index: 1000;
            top: 205px;
            right: -5px;
            width: 75px;
        }

        .miaosha_content_div{
            padding:10px 10px 80px 10px;
            position: relative;
        }
        .miaoshaqu{
            position: absolute;
            height: 1.5rem;
            width:6.5rem;
            top:-0.75rem;
            left:50%;transform: translate(-50%,0);-webkit-transform: translate(-50%,0);
        }
        .miaoshaqu>img{
            width: 100%;
        }
        .hotel_img{
            height: 7rem;
            position: relative;
            background: #ddd;
            border-radius: 8px 8px  0 0;
        }
        .hotel_img>img{
            width: 100%;
            height: 100%;
            border-radius: 8px 8px  0 0;
        }
        .hotel_txt{
            font-size: .7rem;
            background: #fff;
            padding: 10px;
            border-radius:0 0 8px 8px;
        }
        .hotel_title{
            font-size: 0.8rem;
            line-height: 1rem;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .hotel_address{
            font-size: 0.6rem;
            line-height: 1rem;
            color:#666 ;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .qi{
            display: inline-block;
            width: 2.25rem;
            height: 1.125rem;
        }
        .qi>img{
            width: 100%;
            height: 100%;
        }
        .xiangqing{
            display: inline-block;
            padding: .5rem 1rem;
            color:#fff;
            /*float: right;*/
            background: #ff5d57;
            border-radius: 8px;
        }
        .xiangqing.operate {
            background: #19a870;
        }
        .disable{
            color: #ddd;
            background: #a3a3a3;
        }
        .look:active {
            color: #ddd;
            background: #f1332b;
        }
        .price_div{
            display: -webkit-box;
            display: -ms-flexbox;
            display: -moz-box;
            display: box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-align: center;
            box-align: center;
            -webkit-align-items: center;
            align-items: center;
            position: relative;
        }
        .qi_div{
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
        }
        #hotelmask{
            position: absolute;
            font-size: .7rem;
            right: .4rem;
            top:-.15rem;
            height: 3.625rem;
            width: 3rem;
            /*background: url(http://source.qunar.com/site/images/wap/touch/images/v2/images1x/miaosha_yijishu.png) 0 0 no-repeat;*/
            background-size:100% 100%;
            /*color:#d4d4d4;*/
        }
        #hotelmask>div{
            position: absolute;
            width: 2.25rem;
            line-height: .7rem;
            top:35% ;
            text-align: center;
            left:45%;transform: translate(-50%,0);-webkit-transform: translate(-50%,0);
        }
        .jieshu{
            background: url(http://source.qunar.com/site/images/wap/touch/images/v2/images1x/miaosha_js.png) 0 0 no-repeat;
            background-size:100% 100%;
            color:#d4d4d4;
        }
        .jinxing{
            background: url(http://source.qunar.com/site/images/wap/touch/images/v2/images1x/miaosha_jx.png) 0 0 no-repeat;
            background-size:100% 100%;
            color:#fff;
        }
        .kaimiao{
            background: url(http://source.qunar.com/site/images/wap/touch/images/v2/images1x/miaosha_ks2.png) 0 0 no-repeat;
            background-size:100% 100%;
            color:#fff;
        }

        .tehui_content{
            padding: 1.25rem 0.325rem;
            border-top: 1px dashed #19a870;
            position: relative;
            background: #250749;
        }
        .nav{
            font-size: .7rem;
            color:#572700;
            line-height: 1.5rem;
        }
        .nav_table {
            width: 100%;
            padding: .15rem;
            font-size: 0;
            box-sizing: border-box;
            /*background: #f8be00;*/
        }
        .nav_table div:not(.more_city_div) {
            line-height: 1.5rem;
            text-align: center;
            vertical-align: middle;
            /*border:3px solid transparent;*/
            color: #fff;
            display: inline-block;
            background: #f39712;
            box-sizing: border-box;
            width: 24.9%;
            font-size: .7rem;
            border:.15rem solid #ffd650;
        }
        .list_hotel_img{
            height:4.75rem;
            width: 100%;
            background: #ddd;
        }
        .list_hotel_img>img{
            height:100%;
            width: 100%;
        }
        /*.hotel_list{*/
        /*padding: 1px;*/
        /*overflow: hidden;*/
        /*}*/
        /** 68元封顶 */
        .list{
            /*padding: 1px;*/
            /*overflow: hidden;*/
            font-size: 0;
        }
        .list >div{
            display: inline-block;
            width: 49.9%;
            padding: .2rem;
            box-sizing: border-box;
        }
        .list .list_hotel_img {
            position: relative;
            height: 5.5rem;
        }
        .list_hotel_commentScore {
            position: absolute;
            top: 0;
            left: 0;
            width: 2.25rem;
            height: 1.3rem;
            line-height: 1.3rem;
            font-size: .6rem;
            color: #ffcc00;
            text-align: center;
            background: rgba(0, 0, 0, .5);
        }
        .list_hotel_commentScore:after {
            position: absolute;
            top: 100%;
            left: 0;
            width: 2.25rem;
            height: 1.3rem;
            content: '\0020';
            box-sizing: border-box;
            border-width: .65rem 1.125rem 0 1.125rem;
            border-style: solid;
            border-color: rgba(0, 0, 0, .5) transparent transparent transparent;
        }
        .list_hotel_commentScore .commentScore {
            font-size: .8rem;
        }
        .list_hotel_soldOut {
            display: none;
        }
        .soldOut .list_hotel_soldOut {
            display: block;
            box-sizing: border-box;
            position: absolute;
            top: 1.5rem;
            left: 0;
            right: 0;
            margin: 0 auto;
            width: 2.5rem;
            height: 2.5rem;
            padding-top: .5rem;
            border-radius: 1.25rem;
            font-size: .7rem;
            text-align: center;
            color: rgba(255, 255, 255, .7);
            background: rgba(0, 0, 0, .6);
        }
        .list .list_hotel_txt{
            height: 2.7rem;
            background: #fff;
            /*border-radius: 0 0 5px 5px;*/
        }
        .list_hotel_priceDiv{
            height: 1.35rem;
            font-size: .7rem;
            overflow: hidden;
            display: -webkit-box;
            display: -ms-flexbox;
            display: -moz-box;
            display: box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-align: center;
            box-align: center;
            -webkit-align-items: center;
            align-items: center;
        }
        .list_hotel_price{
            -webkit-box-flex: 3;
            -webkit-flex: 3;
            -ms-flex: 3;
            flex: 3;
            height: 1.35rem;
            line-height: 1.35rem;
            font-size: .6rem;
            color: #ffee31;
            background: #ff5d57;
            box-sizing: border-box;
        }
        .soldOut .list_hotel_price {
            color: #333;
            background: #888;
        }
        .list_hotel_price .price{
            margin-left: .3rem;
            font-size: .9rem;
            position: relative;
            top:.05rem
        }
        .soldOut .list_hotel_price .price {
            text-decoration: line-through;
        }
        .list_hotel_watch{
            position: relative;
            -webkit-box-flex: 4;
            -webkit-flex: 4;
            -ms-flex: 4;
            flex: 4;
            height: 1.35rem;
            line-height: 1.35rem;
            background: #402727;
        }
        .soldOut .list_hotel_watch {
            background: #ff5d57;
        }
        .list_hotel_watch:after {
            position: absolute;
            left: 0;
            top: 0;
            height: 1.35rem;
            width: .6rem;
            content: '\0020';
            box-sizing: border-box;
            border-width: .675rem 0 .675rem .3rem;
            border-style: solid;
            border-color: transparent transparent transparent #ff5d57;
        }
        .soldOut .list_hotel_watch:after {
            border-color: transparent transparent transparent #888;
        }
        .list_hotel_watch_div{
            margin-left: .6rem;
            text-align: center;
            color: #d7514c;
        }
        .soldOut .list_hotel_watch_div {
            color: #ffee31;
        }
        .list_hotel_title{
            padding: 0 .2rem;
            height: 1.35rem;
            line-height: 1.35rem;
            color: #402727;
            font-size: .6rem;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .list_hotel_address{
            font-size: .6rem;
            line-height: 1rem;
            height: 1rem;
            color:#666;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .yen{
            font-size: .6rem;
            color:#ff5d57 ;
        }
        /**
         * 新高星特惠
         */
        .list .list_hotel2_img {
            position: relative;
            height: 5.85rem;
        }
        .list_hotel2_img .hotel2_title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: .2rem .3rem;
            font-size: .6rem;
            line-height: .85rem;
            color: #fff;
            background: rgba(0, 0, 0, .5);
            /*text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;*/
        }
        .list .list_hotel2_txt {
            height: 3.15rem;
            background: #fff;
        }
        .hotel2_areaDiv {
            padding: 0 .25rem;
            height: 1.4rem;
            line-height: 1.4rem;
            font-size: 0;
        }
        .hotel2_starLevel {
            float: left;
            /*display: inline-block;*/
            padding: 1px 2px;
            margin-top: .3rem;
            vertical-align: top;
            font-size: .6rem;
            line-height: 1;
            color: #fb524a;
            border: 1px solid #fb524a;
            border-radius: 2px;
        }
        .hotel2_area {
            /*display: inline-block;*/
            padding: 0 .2rem;
            font-size: .6rem;
            color: #666;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
        }
        .hotel2_priceDiv {
            height: 1.5rem;
        }
        .hotel2_price {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            height: 1.5rem;
            line-height: 1.5rem;
            font-size: .6rem;
            color: #666;
            background: #fff;
            box-sizing: border-box;
        }
        .hotel2_price .price {
            font-size: 1.2rem;
            letter-spacing: -1;
            color: #fb524a;
            position: relative;
            top: .05rem
        }
        .hotel2_price .yen {
            margin-left: .3rem;
            color: #fb524a;
        }
        .hotel2_watch {
            position: relative;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            height: 1.5rem;
            line-height: 1.5rem;
            background: #fb524a;
        }
        .hotel2_watch:after {
            position: absolute;
            left: 0;
            top: 0;
            height: 1.5rem;
            width: 1rem;
            content: '\0020';
            box-sizing: border-box;
            border-width: .75rem 0 .75rem .5rem;
            border-style: solid;
            border-color: transparent transparent transparent #fff;
        }
        .hotel2_watch_div {
            margin-left: .5rem;
            text-align: center;
            color: #fff;
        }
        /*******************/

        .nav_table .nav_active{
            background: #feff73!important;
            color: #5a3500!important;
        }
        .nav_table div:not(.more_city_div):active{
            background: #eed123!important;
        }
        .alert {
            position: fixed;
            z-index: 1001;
            width: 80%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            -webkit-transform: translate(-50%, -50%);
            background: #fff;
            ##display: none;
            background: #fff;
            ##min-height:100px;
            font-size:14px;
            box-sizing: border-box;
            border-radius: 10px;
            -webkit-border-radius: 10px;
        }
        .alt-mask{
            position: fixed;
            top:0;
            left:0;
            width: 100%;
            height: 100%;
            z-index: 1000;
            ##display: none;
            background: rgba(0,0,0,.5);
        }
        .al-title{
            font-size: 16px;
            font-weight: bold;
            line-height: 20px;
            box-sizing: border-box;
            padding:10px;
            position: relative;
            text-align:center
        }
        .al-txt{
            font-size: 14px;
            line-height: 20px;
            color: #888888;
            box-sizing: border-box;

        }
        .msg{
            width:100%;
            box-sizing: border-box;
            padding:0 15px 15px 15px
        }
        .al-txtDiv{
            min-height:30px;
        }

        .hidden{display:none}
        .more_city_div{
            height:0px;
            overflow: hidden;
            transition:height .7s;
            -webkit-transition:height .7s;
            width: 100%;
        }
        .more_city_div_show{
            /*height:auto;*/
            /*height:5.6rem;*/
        }
        .kaimiao >div{
            top: 33% !important;
            left: 47% !important;
        }
        .hotel_area{
            padding:.25rem;
        }
        .tip-mask{color:#fff;font-size:14px;position: fixed;top:0;width: 100%;height: 100%;z-index: 1000;background: rgba(0,0,0,.5);}
        .mask_div{width:100%;text-align:center}
        .fenxiang{line-height:80px;width:180px;margin:0 auto}
        .right_top{padding-top:100px;background: url(http://source.qunar.com/site/images/wap/touch/images/v2/images1x/lb_arrows.png) right 10px no-repeat;background-size:75px 100px;margin:0 10px;line-}

        .yuan_div{
            display: -webkit-box;
            display: -ms-flexbox;
            display: -moz-box;
            display: box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-align: center;
            box-align: center;
            -webkit-align-items: center;
            align-items: center;
            position: absolute;
            top:0
        }
        /*.qi_div span{display: inline-block}*/
        .yuan{color:#ff5d57;font-size: 1.5rem;font-weight: bolder;font-style:oblique;}
        .yuanqi{color:#888;padding-top: .4rem;padding-left:3px}
        /*.miaosha_disable{position: relative}*/
        .miaosha_disable .yuan{color:#666;}
        .miaosha_disable:after{
            content: '';
            display: block;
            width: 100%;
            height: 1px;
            background: #888;
            position: absolute;
            left: 0;
            top:50%
        }
        .goto_zhongdianfang{
            background: #ff9000;
            font-size: .9rem;
            line-height: 2rem;
            text-align: center;
            color:#fff;
            border-radius: 5px;
            margin:.5rem .25rem 0 .25rem;
        }
        .red_package{
            padding-top: 20px;
            padding-bottom: 1px;
            width: 100%;
        }
        .red_package>img{
            width: 100%;
        }
        .hidden_img{
            display:none;
        }
        .miaosha_tab{
            font-size: .7rem;
            display: -webkit-box;
            display: -ms-flexbox;
            display: -moz-box;
            display: box;
            display: -webkit-flex;
            display: flex;
            width: 100%;
            overflow: hidden;
            padding-top: .3rem;
        }
        .miaosha_tab>div{
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            text-align:center;
            height: 1.25rem;
            background: #1c96d8;
            color:#fff;
            border-right: 1px solid #20b2ff;
            transform:skew(-25deg);
            -webkit-transform:skew(-25deg);

        }
        .miaosha_tab>div:after{
            content: '';
            width: 100%;
            height: .3rem;
            display: inline-block;
            position: absolute;
            top:-.3rem;
            right: 0;
            background: #20b2ff;
            border-right: 1px solid #20b2ff;
            transform:skew(35deg);
            -webkit-transform:skew(35deg);
        }
        .miaosha_tab>div>div{
            line-height: 1.25rem;
            transform: skew(25deg);
            -webkit-transform:skew(25deg);
        }
        .miaosha_tab .active{
            color: #5a3500;
            background: #ffd64f;
        }
        .miaosha_tab >div:last-child>div:after{
            content: '';
            width: 10%;
            height: 110%;
            display: inline-block;
            position: absolute;
            right:-4%;
            background: #1c96d8;
        }
        .miaosha_tab >div:first-child>div:after{
            content: '';
            width: 10%;
            height: 100%;
            display: inline-block;
            position: absolute;
            left:-4%;
            background: #1c96d8;
        }
        .miaosha_tab >div:first-child:before{
            content: '';
            width: 10%;
            height: .3rem;
            display: inline-block;
            position: absolute;
            left:-8%;
            top:-.3rem;
            transform: skew(25deg);
            -webkit-transform:skew(25deg);
            background: #20b2ff;
        }
        .active>div:after{
            background: #ffd64f!important;
        }
        .active:after{
            background: #ffe884!important;
            border-color: #ffe884;
        }
        .active:before{
            background: #ffe884!important;
        }
        .miaosha_rule{
            font-size: .6rem;
            position: absolute;
            right: -.5rem;
            bottom: 1.5rem;
            padding: 2px;
            border: 1px solid #20b2ff;
            border-radius: 50%;
        }
        .miaosha_rule>div{
            padding: .5rem;
            line-height: .6rem;
            border-radius: 50%;
            color: #fff7a4;
            background: rgba(32, 178, 255, .8); /* #20b2ff  0.8 */
        }
        .alert-rule{
            font-size: .6rem;
            width: 80%;
            position: fixed;
            top:50%;
            left:50%;
            transform: translate(-50%,-50%);
            -webkit-transform: translate(-50%,-50%);
            background: #fffacd;
            border-radius: 5px;
            z-index: 1001;
        }
        .arule-title{
            line-height: 2.75rem;
            text-align: center;
            background: url('http://source.qunar.com/site/images/wap/touch/images/v2/images1x/miaosha_rule_img.png');
            background-size: 100% 100%;
            font-size: .8rem;
            color: #fff4d1;
            border-radius: 5px 5px 0 0 ;
        }
        .arule-txtDiv{
            width: 80%;
            margin: 0 auto;
            padding: 1rem 0 .5rem 0;
        }
        .arule-txtDiv>div{
            line-height: 1rem;
            padding: 3px 0;
        }
        .arule-txtDiv>div:before{
            content: '';
            display: inline-block;
            height: .25rem;
            width: .25rem;
            background: #f87b00;
            position: relative;
            top:-.1rem;
            margin-right:.25rem;
        }
        .bottom-img>img{
            width: 100%;
        }

        .bottom-bg{
            background: #f87b00;
            height: 1rem;
            border-top:3px solid #ffa52e;
            border-radius: 0 0 5px 5px ;
        }
        .tip-time-div{
            font-size: .56rem;
            color: #a46939;
            text-align: left;
            padding-top: .5rem;
            padding-left: 5px;
        }
        .icon-small{
            width: .6rem;
            height: .6rem;
            top:1px;
            display: inline-block;
            background: url('http://source.qunar.com/site/images/wap/touch/images/v2/images1x/small.png');
            background-size: 100% 100%;
            margin-right: .25rem;
            position: relative;
        }
        .img-fadeIn{
            -webkit-animation:fadeIn 1s both;
            animation:fadeIn 1s both;

        }
        @-webkit-keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }
        @keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }
        .discount{
            font-size: .6rem;
            color: #828181;
        }
        .tip-end{
            padding-top: 1rem;
            font-size: .8rem;
            text-align: center;
        }
        .gray{
            color:#888;
        }
        .end-tip{
            font-size: .8rem;
            color: #F8C430;
            text-align: center;
            background: #FEF7A4;
            padding: 2rem 0;
        }
        .city_choose {
            width: 100%;
            padding: .15rem;
            font-size: 0;
            box-sizing: border-box;
            overflow: hidden;
        }
        .hotel_cityChoose {
            width: 100%;
            border: none;
            font-size: .6rem;
            color: #fff;
        }
        .hotel_city {
            display: -webkit-box;
            display: -ms-flexbox;
            display: -moz-box;
            display: box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-align: center;
            box-align: center;
            -webkit-align-items: center;
            align-items: center;
            margin: 0 auto;
            width: 10.3rem;
            height: 1.5rem;
            line-height: 1.5rem;
            border-radius: .75rem;
            background: rgba(0, 0, 0, .2);
        }
        .hotel_city_txt {
            position: relative;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            width: auto;
            height: 1.5rem;
            font-size: .6rem;
            color: #fff;
        }
        .hotel_city_txt>span {
            margin-left: 1.15rem;
        }
        .hotel_city_choose {
            position: relative;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            -ms-flex: 1;
            flex: 1;
            width: auto;
            height: 1.5rem;
            border: none;
            font-size: .6rem;
            text-align: center;
            color: #fff;
            cursor: pointer;
        }
        .hotel_city_choose>span {
            position: relative;
            margin-right: 1.15rem;
        }
        .hotel_city_choose>span:after {
            content: '\0020';
            position: absolute;
            /*right: -36px;*/
            top: -.05rem;
            margin-left: .5rem;
            width: .75rem;
            height: .75rem;
            border-radius: .375rem;
            background-color: #ff5d57;
            background-image: url(http://simg1.qunarzz.com/site/images/zhuanti/huodong/20160112seckill_arrow.png);
            background-repeat: no-repeat;
            background-size: cover;
        }
        .popup-citylist {
            position: fixed;
            z-index: 1001;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            left: 0;
            top: 0;
            bottom: 0;
            background: rgba(0, 0, 0, .9);
            font-size:14px;
            box-sizing: border-box;
        }
        .popupNoCity {
            color: #ccc;
            text-align: center;
        }
        .popupNoCityText {
            font-size: .7rem;
            margin: 3rem auto 1rem;
        }
        .popupNoCityBtn {
            width: 2rem;
            padding: .2rem;
            margin: 1rem auto;
            border: 1px solid #ccc;
            border-radius: 2px;
            font-size: .6rem;
        }
        .city-chooser {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        .city-group {
            padding: 0 0 .3rem;
        }
        .city-group h2 {
            margin: 0;
            padding-left: .3rem;
            height: 1.5rem;
            line-height: 1.5rem;
            font-size: .7rem;
            font-weight: normal;
            color: #eb9e42;
            border-bottom: 1px solid #eb9e42;
        }
        .city-group-list {
            margin: 0;
            padding: .3rem .2rem .2rem;
            width: 15.6rem;
            list-style: none;
            font-size: 0;
        }
        .city-group-list li {
            display: inline-block;
            margin: .8%;
            width: 23.4%;
            line-height: 1.5rem;
            /*border: .15rem solid rgba(0, 0, 0, .9);*/
            box-sizing: border-box;
            font-size: .7rem;
            text-align: center;
            vertical-align: middle;
            color: #fff;
            background: #eb9e42;
        }
        .city-group-list li.active {
            color: #921100;
            background: #fff7a4;
        }
    </style>
    <script src="http://api.map.baidu.com/getscript?v=1.4a"></script>
</head>
<body>

<div class="main">
    <div class="hidden_img">
        <img src="http://source.qunar.com/site/images/wap/touch/images/v2/images1x/nvshen.png">
    </div>
    <div class="img_div">
        <img src="http://img1.qunarzz.com/m_appPromotion/wap/1603/4d/689468c1ac9c1ff7.jpg">
        <div class="qianghongbao">
            <a href="http://touch.qunar.com/h5/red/giftpacket_v2?bd_source=dalibao_gxyyq">
                <img src="http://img1.qunarzz.com/m_appPromotion/wap/1603/6b/908d1895e37c7af7.png">
            </a>
        </div>

    </div>
    <div class="miaosha_content hidden">
        <div class="miaosha_tab">
            <div name="miaosha"><div>一元秒杀</div></div>
            <div name="zhekou"><div>68元封顶</div></div>
            <div name="tehui"><div>高星特惠</div></div>
        </div>
        <div class="tip-time-div">
            <span class="tip-time">·每天12点开秒，限当日入住;</span><br/>
            <span class="tip-time">·48小时内限购1单，每单1间夜;</span><br/>
            <span class="tip-time">·此优惠不与其他优惠同享，预订规则以实际订购页面为准。</span>
        </div>
        <div class="miaosha_content_div">
            <!-- <div class="miaoshaqu hidden">
                <img src="http://source.qunar.com/site/images/wap/touch/images/v2/images1x/miaosha_yiyuan.png">
            </div> -->
            <div class="nav">
                <div class="nav_table">

                </div>
                <div class="city_choose hidden">

                </div>
            </div>
            <div class="miaosha_list">

            </div>

        </div>

    </div>
    <div class="alert hidden">
        <div class="al-title">去哪儿网温馨提示：</div>
        <div class="al-txtDiv">
            <!--<div class="al-txt msg">请输入11位有效手机号</div>-->
        </div>
    </div>
    <div class="alt-mask hidden"></div>

    <div class="popup-citylist hidden"></div>

    <div class="tip-mask hidden">
        <div class="mask_div">
            <div class="right_top">1、点击右上角&nbsp;•••</div>
            <div class="fenxiang">2、在浏览器中打开</div>
        </div>

    </div>
</div>
<script type="text/template" id="citytpl">
    <%
    var n=0,length=count(data);
    _.each(data,function(item,index){
    %>
        <%if(length>8 && n==7){%>
        <div class="moreCity">更多城市</div>
        <div class="more_city_div">
        <%}%>
        <div class="<%if(n==0){%>td1<%}%>" name="<%=index%>"><%=index%></div>
        <%
        n++;
    });
    %>
    <%if(data.length>8){%>
    </div>
    <%}
    function count(o){
    var t = typeof o;
    if(t == 'string'){
    return o.length;
    }else if(t == 'object'){
    var n = 0;
    for(var i in o){
    n++;
    }
    return n;
    }
    return false;
    };
    %>
</script>
<script type="text/template" id="citytpl2">
    <%
    var n=0,length=count(data);
    _.each(data,function(item,index){
    %>
        <%if(length>8 && n==7){%>
        <div class="moreCity">更多城市</div>
        <div class="more_city_div">
        <%}%>
        <div class="<% if(n === 0) { %> td1 <% } %>" name="<%=item.cityName%>" cityurl="<%=item.cityUrl%>"><%=item.cityName%></div>
        <%
        n++;
    });
    %>
    <%if(data.length>8){%>
    </div>
    <%}
    function count(o){
    var t = typeof o;
    if(t == 'string'){
    return o.length;
    }else if(t == 'object'){
    var n = 0;
    for(var i in o){
    n++;
    }
    return n;
    }
    return false;
    };
    %>
</script>
<script type="text/template" id="citytpl3">
    <% if(_.isEmpty(data)) { %>
    <div class="popupNoCity">
        <div class="popupNoCityText">无更多城市</div>
        <div class="popupNoCityBtn">返回</div>
    </div>
    <% } %>
    <div class="city-chooser">
    <% var n = 0; %>
    <% _.each(data, function(elem, index) { %>
        <% if(elem.length <= 0) return; %>
        <div class="city-group">
            <h2><%- index %></h2>
            <ul class="city-group-list">
                <% _.each(elem, function(val, idx) { %>
                <li class="<% if(n===0) { %>td1<% } %>" name="<%- val.cityName %>" cityurl="<%- val.cityUrl %>"><%- val.cityName %></li>
                <% n++; %>
                <% }); %>
            </ul>
        </div>
    <% }); %>
    </div>
</script>
<script type="text/template" id="cityChoose">
    <div class="hotel_cityChoose">
        <div class="hotel_city">
            <div class="hotel_city_txt"><span>请选择城市：</span></div>
            <div class="hotel_city_choose"><span><%- city %></span></div>
        </div>
    </div>
</script>
<script type="text/template" id="miaoshatpl">
    <%if(data.hotels.length==0){%>
        <div class="end-tip">该城市今日秒杀活动已结束，感谢您的参加~~</div>
    <%}%>
    <%_.each(data.hotels,function(item,index){%>
    <% if(item.roomStatusCode < 0 || item.roomStatusCode > 3) return;%>
    <div class="hotel_area" data-startTime="<%=data.killTime%>" data-seq="<%=item.seq%>" data-mobileRoomStatus="<%=item.mobileRoomStatus%>">
        <div class="hotel_img" data-seq="<%=item.seq%>">
            <%
            var imgsrc=item.imageUrl;
            var end=imgsrc.substr(imgsrc.length-6,6);
            end=='76.jpg' && (imgsrc=imgsrc.replace(imgsrc.substr(imgsrc.length-6,6),'480.jpg'));
            %>
            <img lazy_src="<%=imgsrc%>">
            <% if (item.roomStatusCode === 0 || item.roomStatusCode === 1) { %>
                <div id='hotelmask' class="hotelmask kaimiao">
                    <div class="mask_txt"><%=data.killTime%><br>开&nbsp;抢</div>
                </div>
            <% } else if (item.roomStatusCode === 2) { %>
                <div id='hotelmask' class="hotelmask jinxing">
                    <div class="mask_txt"><%=data.killTime%><br>进行中</div>
                </div>
            <% } else if (item.roomStatusCode === 3) { %>
                <div id='hotelmask' class="hotelmask jieshu">
                    <div class="mask_txt">已结束</div>
                </div>
            <%}%>
        </div>
        <div class="hotel_txt">
            <div class="hotel_title"><%=item.name%></div>
            <div class="hotel_address"><%=item.area%></div>
            <div class="price_div">
                <div class="qi_div">
                    <div class="yuan_div ">
                        <div class="yuan <%if(item.roomStatusCode==-1){%>gray<%}%>"><%=item.mobilePrice%></div>
                        <div class="yuanqi">元起</div>
                    </div>
                </div>
                <% if (item.roomStatusCode === 0 && !item.hotelIsFollowed) { %>
                <div class="xiangqing operate wantFollow" data-seq="<%=item.seq%>">我要关注</div>
                <% } else if (item.roomStatusCode === 0 && item.hotelIsFollowed) { %>
                <div class="xiangqing cancelFollow" data-seq="<%=item.seq%>">取消关注</div>
                <% } else if (item.roomStatusCode === 1) { %>
                <div class="xiangqing disable" data-seq="<%=item.seq%>">即将开始</div>
                <% } else if (item.roomStatusCode === 2) { %>
                <div class="xiangqing operate" data-seq="<%=item.seq%>">立即秒杀</div>
                <% } else if (item.roomStatusCode === 3) { %>
                <div class="xiangqing" data-seq="<%=item.seq%>">查看其他房型</div>
                <%}%>

            </div>
        </div>
    </div>
    <%});%>

</script>
<script type="text/template" id="hoteltpl">
    <%if(data.hotels.length==0){%>
    <div class="end-tip">该城市今日的低价酒店已被抢光，感谢您的参与~</div>
    <%}%>
 <div class="hotel_list">
    <div class="list ">
        <%_.each(data.hotels,function(item,index){%>
            <% var roomStatus = 'onSail'; %>
            <% if(item.roomStatusCode === 4) { %>
            <%    roomStatus = 'onSail'; %>
            <% } else if(item.roomStatusCode === 5) { %>
            <%    roomStatus = 'soldOut'; %>
            <% } %>
        <div data-seq="<%=item.seq%>" class="<%- roomStatus %>">
            <div class="list_hotel_img list_hotel_68" data-seq="<%=item.seq%>">
                <%
                var imgsrc=item.imageUrl;
                var end=imgsrc.substr(imgsrc.length-6,6);
                end=='76.jpg' && (imgsrc=imgsrc.replace(imgsrc.substr(imgsrc.length-6,6),'240.jpg'));
                %>
                <img lazy_src="<%=imgsrc%>">
                <div class="list_hotel_commentScore">
                    <span class="commentScore"><%- item.commentScore %></span>分
                </div>
                <div class="list_hotel_soldOut">
                    今日<br>已抢完
                </div>
            </div>
            <div class="list_hotel_txt">
                <div class="list_hotel_priceDiv">
                    <div class="list_hotel_price">
                        <span class="price instant-price" data-id="<%=item.hotelId%>"><%=item.mobilePrice%></span>
                        元起
                    </div>
                    <div class="list_hotel_watch">
                        <div class="list_hotel_watch_div" data-seq="<%=item.seq%>"><% if(roomStatus === 'onSail') { %> 抢购 <% } else { %> 更多优惠 <% } %></div>
                    </div>
                </div>
                <div class="list_hotel_title"><%=item.name%></div>
            </div>
        </div>
        <%});%>
    </div>
 </div>
</script>
<script type="text/template" id="hoteltpl2">
    <%if(data.hotels.length==0){%>
        <div class="end-tip">该城市今日的特惠酒店已被抢光，感谢您的参与~</div>
    <%}%>
    <div class="hotel_list">
        <div class="list">
            <%_.each(data.hotels,function(item,index){%>
            <div data-seq="<%=item.seq%>">
                <div class="list_hotel_img list_hotel2_img list_hotel_gaoxing" data-seq="<%=item.seq%>">
                    <%
                    var imgsrc=item.imageUrl;
                    var end=imgsrc.substr(imgsrc.length-6,6);
                    end=='76.jpg' && (imgsrc=imgsrc.replace(imgsrc.substr(imgsrc.length-6,6),'240.jpg'));
                    %>
                    <img lazy_src="<%=imgsrc%>">
                    <div class="hotel2_title"><%=item.name%></div>
                </div>
                <div class="list_hotel2_txt">
                    <div class="hotel2_areaDiv">
                        <div class="hotel2_starLevel"><%- item.starLevel%></div>
                        <div class="hotel2_area"><%- item.area %></div>
                    </div>
                    <div class="list_hotel_priceDiv hotel2_priceDiv">
                        <div class="hotel2_price">
                            <span class="yen">¥</span><span class="price instant-price" data-id="<%=item.hotelId%>"><%=item.mobilePrice%></span>起
                        </div>
                        <div class="hotel2_watch">
                            <div class="hotel2_watch_div" data-seq="<%=item.seq%>">去抢购</div>
                        </div>
                    </div>
                </div>
            </div>
            <%});%>
        </div>
    </div>
</script>
</body>
<script type="text/javascript" src="http://qunarzz.com/mobile_touch/prd/v2/js/zepto-2014012117315602.js"></script>
<!--<script type="text/javascript" src="http://m.qunar.com/zhuanti/zhongdianfangmiaosha.js"></script>-->
<script>

    $(function() {
        var ua = navigator.userAgent;
        var	v = ua.match(/[qQ]unar.*\/(\d{8})/g);
        var	version = !!v && (parseInt( v[0].split('/')[1]));
        var type=typeof(version);
        if(ua.toLowerCase().indexOf('iphone')!=-1 ){
            if(type=='number'&&version<80011092 ){
                alert('请将客户端升级至最新版本参加本活动');
            }
        }


        var qn241Obj = _.filter(document.cookie.split(';'), function (v) {
            return v.indexOf('QN241') >= 0;
        });
        var qn241Str = qn241Obj && qn241Obj.toString().split('=')[1] || null;
        qn241Str = decodeURIComponent(qn241Str);
        var qn241 = qn241Str && JSON.parse(qn241Str) || null;
        // alert(qn241);
        // alert(typeof qn241);
        var pid = qn241 && qn241.pid || null;
        var vid = qn241 && qn241.vid || null;
        // alert(pid);
        // alert(vid);
        var uParam = getUrlParam('uparam');
        // alert(uParam);


        var appOuid = getUrlParam('appOuid');



        // if(ua.toLowerCase().indexOf('micromessenger')>=0){
            // document.title='去哪儿网女神喊你脱单，钟点房1元抢！';
        // }

        var bdSource=getUrlParam('bd_source') || 'huodonga',
            sourceType = getUrlParam('sourceType') || '',
            city=getUrlParam('city');
        var reg = new RegExp("[\\u4E00-\\u9FFF]+","g");
        if(!reg.test(city)){
            city=decodeURIComponent(city);
        }
        var FromForLog={
            'huodonga_miaosha':147,
            'huodonga_zhekou':148,
            'huodonga_tehui':149,
            'huodonga1_miaosha':151,
            'huodonga1_zhekou':152,
            'huodonga1_tehui':153,
            'huodonga2_miaosha':155,
            'huodonga2_zhekou':156,
            'huodonga2_tehui':157,
            'huodonga3_miaosha':159,
            'huodonga3_zhekou':160,
            'huodonga3_tehui':161,
            'huodonga4_miaosha':163,
            'huodonga4_zhekou':164,
            'huodonga4_tehui':165,
            'huodonga5_miaosha':167,
            'huodonga5_zhekou':168,
            'huodonga5_tehui':169,
            'huodonga6_miaosha':171,
            'huodonga6_zhekou':172,
            'huodonga6_tehui':173,
            'huodonga7_miaosha':175,
            'huodonga7_zhekou':176,
            'huodonga7_tehui':177,
            'huodonga8_miaosha':179,
            'huodonga8_zhekou':180,
            'huodonga8_tehui':181,
            'huodonga9_miaosha':183,
            'huodonga9_zhekou':184,
            'huodonga9_tehui':185,
            'huodonga10_miaosha':189,
            'huodonga10_zhekou':190,
            'huodonga10_tehui':191,
        };
        // var fromForLog=FromForLog[bdSource] || 112;

        // bd_source 来自huodonga3开头的 不显示下载浮层
        if(bdSource.indexOf('huodonga3') == -1) {
            var downloadNode = document.createElement('script');
            downloadNode.type = "text/javascript";
            downloadNode.src = "http://m.qunar.com/zhuanti/20150129-topDownLoad.js";
            $('body').append(downloadNode);
        }


        var qua = function () {
            var ua = navigator.userAgent;
            return {
                iphonePro  : ua.indexOf("QunariPhonePro") !== -1,
                iphoneLife : ua.indexOf("QunariPhoneLife") !== -1,
                iphone     : ua.indexOf("QunariPhone") !== -1,
                androidLife: ua.indexOf("qunaraphonelife") !== -1,
                android    : ua.indexOf("qunaraphone") !== -1,
                ipad       : /ipad/ig.test(ua)
            }
        }();
        var city_data='';

        var date=$.getDateString(new Date());
        $('.miaosha_content').removeClass('hidden');
        // 异步判断是否微信中，微信中展示引导层； 绑定滚动图片懒加载事件
        setTimeout(function(){
            // $('.miaosha_tab>div[name="miaosha"]').trigger('click'); // 首先显示秒杀tab
            if(ua.toLowerCase().indexOf('micromessenger')!=-1){
                showTipMask();
            }
            window.onscroll =throttle(lazy,300);
            lazy();
        },1)

        // 百度地图定位
        var myCity = new BMap.LocalCity();
        var hashcity = location.hash.substr(1) || city;
        function myFun(result) {
            var cityName = result && result.name;
            if (!cityName) {
                cityName = '';
            } else if (/香港/.test(cityName)) {
                cityName = '香港';
            } else if (/澳门/.test(cityName)) {
                cityName = '澳门';
            } else {
                cityName = cityName.split('市')[0];
            }
            // 回调函数中才可以得到cityName
            location.hash = encodeURIComponent(cityName);
            hashcity = cityName || city;

            firstPageLoad();

        }
        // myCity.get(myFun);
        function getLocation(foo) {
            myCity.get(foo);
        }

        // 有seq表示从推送处进入页面
        var seqs = getUrlParam('seqs');
        if(seqs) {
            seqs = decodeURIComponent(seqs);
            // alert(seqs);
            var seqsArr = seqs.split(',');
            var store = {};
            _.each(seqsArr, function(seq) {
                var seqCityUrl = seq.slice(0, seq.lastIndexOf('_'));
                if(store[seqCityUrl]) {
                    store[seqCityUrl] += (seq + ',');
                } else {
                    store[seqCityUrl] = (seq + ',');
                }
            });
            if(Object.keys(store).length > 0) {
                _.each(store, function(val, key) {
                    window.localStorage[key] = val;
                });
            }
            firstPageLoad(store);

        } else { // 不是从推送进入 则遵循定位逻辑.
            getLocation(myFun);
        }

        // 进入页面时显示的城市酒店列表
        function firstPageLoad(store) {
            // 请求秒杀tab下的城市列表
            buildCitySelect(1, function(res) {
                var cityList = res.cityList,
                    length = cityList && cityList.length,
                    firstCityUrl = null,
                    firstCityName = null;
                if(!cityList || length <= 0) { // 没有获取到城市列表
                    clickTab('miaosha');
                    return false;
                }
                if(store && Object.keys(store).length > 0) { // push过来的
                    var storeCityList = Object.keys(store);
                    var resCityList = _.map(cityList, function(elem, index){return elem.cityUrl;});
                    for(var i = 0, len = storeCityList.length; i < len; i++) {
                        var resIndex = resCityList.indexOf(storeCityList[i]);
                        if(resIndex > -1) {
                            firstCityUrl = storeCityList[i];
                            firstCityName = cityList[resIndex].cityName;
                            break;
                        }
                    }
                } else { // 定位过来的
                    for(var i = 0; i < length; i++) {
                        if(hashcity === cityList[i].cityName) {
                            firstCityUrl = cityList[i].cityUrl;
                            firstCityName = cityList[i].cityName;
                        }
                    }
                }
                if(!firstCityUrl) { // push参数或定位都没有得到cityUrl，则使用城市列表第一个
                    firstCityUrl = cityList[0].cityUrl;
                    firstCityName = cityList[0].cityName;
                }
                location.hash = encodeURIComponent(firstCityName);
                // location.hash = firstCityName;
                getHotelListAjax(firstCityUrl, 1, function(data) {
                    var tabId = data.tabId * 1,
                        tabName = 'miaosha';
                    if(tabId >= 0) {
                        switch(tabId) {
                            case 0: // 秒杀
                                tabName = 'miaosha';
                                break;
                            case 1: // 68封顶
                                tabName = 'zhekou';
                                break;
                            case 2: // 高星特惠
                                tabName = 'tehui';
                                break;
                            default:
                                tabName = 'miaosha';
                        }
                    } else {
                        tabName = 'miaosha';
                    }
                    clickTab(tabName);
                });
                return false;
            });

            // 点击tab
            function clickTab (str) {
                $('.miaosha_tab>div[name="'+str+'"]').trigger('click');
            }
        }


        /** 切换tab */
        $('.main').on('click','.miaosha_tab>div',function(){
            var $me=$(this),
                name=$me.attr('name');
            if($me.hasClass('active')) { // 是当前tab 则直接返回
                return;
            }
            $('.miaosha_tab>div').removeClass('active');
            $me.addClass('active');
            if(name=='miaosha'){
                $('.tip-time-div').removeClass('hidden');
                buildCitySelect(1);
            }else if(name=='zhekou'){
                $('.tip-time-div').addClass('hidden');
                buildCitySelect(4);
            }else if(name=='tehui'){
                $('.tip-time-div').addClass('hidden');
                buildCitySelect(2);
            }
        });

        // 请求该tab下的城市列表
        function buildCitySelect(type, foo){
            $.ajax({
                url     : 'http://tchotel24.beta.qunar.com/h5/hotel/activity/SecKillV2HotelCities',
                data    : {
                    type: type,
                    uparam: uParam,
                    pid: pid,
                    vid: vid
                },
                dataType: 'json',
                // xhrFields: {
                //   withCredentials: true
                // },
                // beforeSend: function (xhr) {
                //     xhr.setRequestHeader('Set-Cookie', qn241);
                // },
                success : function (data) {
                    var fooResult = foo && foo(data); // 如果传入了回调，则优先执行回调
                    if(foo && !fooResult) {return;} // 如果回调函数返回false，则直接退出本次函数处理

                    cityGroups = data.cityGroups || null;
                    if(cityGroups) {
                        cityList = _.flatten(_.map(cityGroups, function(elem, index) {
                            return elem;
                        }));
                    } else {
                        cityList = data.cityList;
                    }

                    city_data=cityList;
                    if(type === 4) { // 68元封顶城市分组列表
                        $('.city_choose').html('');
                        $('.popup-citylist').html('');
                        $('.nav_table').addClass('hidden');
                        $('.city_choose').removeClass('hidden');
                        bulidTemple({city: hashcity},'.city_choose','#cityChoose'); // 城市选择
                        bulidTemple({data: cityGroups}, '.popup-citylist', '#citytpl3'); // 城市列表
                        var hashcity = decodeURIComponent(location.hash.substr(1)) || city;
                        var $chick=$('.city-group-list li[name="'+hashcity+'"]');
                        $chick.length>0 ? $chick.trigger('click') : $('.city-group-list li.td1').trigger('click'); // 点击URL中携带的城市或第一个城市
                    } else {
                        $('.nav_table').html('');
                        $('.city_choose').addClass('hidden');
                        $('.nav_table').removeClass('hidden');
                        bulidTemple({data:cityList},'.nav_table','#citytpl2');
                        var hashcity = decodeURIComponent(location.hash.substr(1)) || city;
                        var $chick=$('.nav_table div[name="'+hashcity+'"]');
                        if($chick.length > 0) { // 点击URL中携带的城市或第一个城市
                            $chick.trigger('click');
                            var $moreCityDiv = $chick.closest('.more_city_div');
                            // alert($moreCityDiv.length)
                            if($moreCityDiv.length>0 && !$moreCityDiv.hasClass('more_city_div_show')) {
                                $('.nav_table>div.moreCity').trigger('click');
                            }
                        } else {
                            $('.td1').trigger('click');
                        }
                    }
                },
                error   : function () {
                    console.log('网络错误，请稍后重试！');
                }
            });
        }

        /** 秒杀规则 */
        $('.main').on('click','.miaosha_rule',function(){
            showAlertRule();
        })
        function showTipMask(){
            var _alt_mask=$('.tip-mask');
            _alt_mask.removeClass('hidden');
            $('.main').one('click',function(e){
                e.stopPropagation();
                e.preventDefault();
                _alt_mask.addClass('hidden');
                $('.main').unbind('touchmove');
            }).on('touchmove',function(e){
                e.preventDefault();
            });
        }

        function bulidTemple(data,element,tpl){
            var element = $(element);
            var tpl = $(tpl).html();
            var render = _.template(tpl);
            var html = render(data);
            element.append(html);
        }
        function isEmptyObject(obj){
            if(obj && typeof(obj)=='object'){
                for(var n in obj){return false}
            }
            return true;
        }

        /** 获取城市中的酒店 */
        function getHotelListAjax(cityUrl, type, fun){
            $.ajax({
                url     : 'http://tchotel24.beta.qunar.com/h5/hotel/activity/SecKillV2HotelList',
                data    : {
                    cityUrl: cityUrl,
                    type: type,
                    seqs: window.localStorage[cityUrl] || '',
                    uparam: uParam,
                    pid: pid,
                    vid: vid
                },
                dataType: 'json',
                // xhrFields: {
                //   withCredentials: true
                // },
                // beforeSend: function (xhr) {
                //     xhr.setRequestHeader('Set-Cookie', qn241);
                // },
                success : function (data) {
                    fun(data);
                },
                error   : function () {
                    console.log('网络错误，请稍后重试！');
                }
            });
        }

        /** 展示秒杀tab页面 */
        function showMiaoshaTab(data) {
            var miaoshaData=data;

            miaoshaData.killTime = data.secKillTimes[0] && data.secKillTimes[0].start || '12:00';

            if(!isEmptyObject(miaoshaData)){
                $('.tip-time-div').removeClass('hidden');
                // $('.tip-time').html(miaoshaData.secKillMsg);
                bulidTemple({data:miaoshaData},'.miaosha_list','#miaoshatpl');
                lazy();
            }
        }

        /** 展示68元封顶tab页面 */
        function showZhekouTab(data) {
            if(!isEmptyObject(data)){
                bulidTemple({data:data},'.miaosha_list','#hoteltpl');
                lazy();
            }
        }

        /** 展示高星特惠tab页面 */
        function showTehuiTab(data) {
            if(!isEmptyObject(data)){
                bulidTemple({data:data},'.miaosha_list','#hoteltpl2');
                lazy();
            }
        }

        /** 秒杀计时器，每次调用时校准一次时间，仅用于12点秒杀且11:55之前为关注按钮的情形 */
        var timer = null;
        function miaoshaTimer(sysTime, startTime, pushBeforeStartMinutes) {
            var curTime = sysTime * 1;
            timer && clearInterval(timer);
            timer = setInterval(function() {
                curTime += 1000;
                var timeStart = getDateTime(startTime);
                var timePush = timeStart - pushBeforeStartMinutes*60*1000;
                if(curTime - timePush < 0) { // 11:55之前
                    return; // no change
                } else if(curTime - timePush >= 0 && curTime - timeStart < 0) { // 11:55 ~ 12:00
                    $('.hotel_area').find('.xiangqing').attr('class', 'xiangqing disable').html('即将开始');
                } else { // 12:00之后
                    clearInterval(timer);
                    var hotelsNode = $('.hotel_area');
                    for (var i = hotelsNode.length-1; i >= 0; i --) {
                        var $hotel = $(hotelsNode[i]),
                            status = $hotel.find('.mask_txt').html();
                        if (status === '已结束') {
                            continue;
                        }
                        $hotel.find('.xiangqing').attr('class', 'xiangqing operate').html('立即秒杀');
                        $hotel.find('.hotelmask').attr('class', 'hotelmask jinxing').find('.mask_txt').html(startTime+'<br>进行中');
                    }
                }

            }, 1000);

            function getDateTime(d) {
                var curDate = new Date();
                var dStr = curDate.getFullYear() + '/' + (curDate.getMonth()+1) + '/' + curDate.getDate() + ' ' + d;
                return new Date(dStr).getTime();
            }
        }

        var intervalList={}, roomIdList=[];
        var seqString='';
        /** 点击城市列表中的城市 1 2 */
        $('.main').on('click', '.nav_table div:not(.more_city_div)',function(){
            if($(this).attr('class')!='moreCity'){
                var $me=$(this),
                    city=$me.html(),
                    cityUrl=$me.attr('cityurl');
                location.hash = encodeURIComponent(city);
                $('.nav_table div').removeClass('nav_active');
                $me.addClass('nav_active');
                var avtiveName=$('.miaosha_tab .active').attr('name'); // 在哪个tab下
                $('.miaosha_list').html('');

                if(avtiveName=='miaosha'){
                    getHotelListAjax(cityUrl, 1, function(data) {
                        showMiaoshaTab(data);
                        var sysTime = data.sysTime,
                            startTime = data.secKillTimes && data.secKillTimes.length>0 && data.secKillTimes[0].start || '12:00',
                            pushBeforeStartMinutes = data.secKillTimes && data.secKillTimes.length>0 && data.secKillTimes[0].pushBeforeStartMinutes || 5;
                        sysTime && miaoshaTimer(sysTime, startTime, pushBeforeStartMinutes);
                    });
                }else if(avtiveName=='zhekou'){
                    getHotelListAjax(cityUrl, 4, showZhekouTab);
                }else if(avtiveName=='tehui'){
                    getHotelListAjax(cityUrl, 2, showTehuiTab);
                }

            }else{ // 点击更多城市或收起城市
                var $more_city_div=$('.more_city_div');
                if($more_city_div.hasClass('more_city_div_show')){
                    $more_city_div.removeClass('more_city_div_show');
                    $more_city_div.css({height:'0'});
                    $(this).html('更多城市');
                }else{
                    $more_city_div.addClass('more_city_div_show');
                    $more_city_div.css({height:Math.ceil((count(city_data)-7)/4)*1.8+'rem'});
                    $(this).html('收起城市');
                }
            }

        });

        /** 点击68元封顶中的城市选择 */
        $('.main').on('click', '.hotel_city_choose', function() {
            var popupCityChooseLayer = $('.popup-citylist'),
                altMask = $('.alt-mask');
            popupCityChooseLayer.removeClass('hidden');
            altMask.removeClass('hidden');

            // 将主页面高度固定
            var mainHeight = $(window).height() - $('#jq-appendDIV').height();
            $('.main').css({
                height: mainHeight,
                overflow: 'hidden'
            });


            $('.popupNoCityBtn').one('click', function() {
                popupCityChooseLayer.addClass('hidden');
                altMask.addClass('hidden');

                // 取消主页面高度固定
                $('.main').removeAttr('style');
            });
        });

        /** 点击68元封顶城市列表中的城市 4 */
        $('.main').on('click', '.city-group-list li', function(e) {
            var $me=$(this),
                city=$me.html(),
                cityUrl=$me.attr('cityurl');
            var popupCityChooseLayer = $('.popup-citylist'),
                altMask = $('.alt-mask');

            // 取消主页面高度固定
            $('.main').removeAttr('style');

            if($me.hasClass('active')) { // 没有改变城市
                popupCityChooseLayer.addClass('hidden');
                altMask.addClass('hidden');
                return;
            }

            location.hash = encodeURIComponent(city);
            $('.city-group-list li').removeClass('active');
            $me.addClass('active');
            $('.miaosha_list').html(''); // 清空城市列表

            getHotelListAjax(cityUrl, 4, function(data) {
                if(!isEmptyObject(data)){
                    bulidTemple({data:data},'.miaosha_list','#hoteltpl');
                    lazy();
                }
            });

            $('.hotel_city_choose span').html(city);
            popupCityChooseLayer.addClass('hidden');
            altMask.addClass('hidden');
        });

        /** 计算对象中子对象数目 */
        function count(o){
            var t = typeof o;
            if(t == 'string'){
                return o.length;
            }else if(t == 'object'){
                var n = 0;
                for(var i in o){
                    n++;
                }
                return n;
            }
            return false;
        };

        function showAlert(msg,title){
            var _alert=$('.alert'),_alt_mask=$('.alt-mask');
            _alert.removeClass('hidden');
            _alt_mask.removeClass('hidden');
            $('.al-title').html(title || '去哪儿网温馨提示：');
            $('.msg').html(msg);
            $('.main').one('click',function(e){
                e.stopPropagation();
                e.preventDefault();
                _alert.addClass('hidden');
                _alt_mask.addClass('hidden');
                $('.main').unbind('touchmove');
            }).on('touchmove',function(e){
                e.preventDefault();
            });
        }

        function showAlertRule(){
            var _alert=$('.alert-rule'),_alt_mask=$('.alt-mask');
            _alert.removeClass('hidden');
            _alt_mask.removeClass('hidden');
            $('.main').one('click',function(e){
                e.stopPropagation();
                e.preventDefault();
                _alert.addClass('hidden');
                _alt_mask.addClass('hidden');
                $('.main').unbind('touchmove');
            }).on('touchmove',function(e){
                e.preventDefault();
            });
        }

        function buildMiaosha(dom,list){
            this.$dom=$(dom);
            this.$list=$(list)
            this.interval= 0;
            this.init();
        }
        buildMiaosha.prototype = {
            init:function(price){
                var me=this,$dom=this.$dom;
                if(price && price>0){$($dom.find('.yuan')).html(price);}
                setState();
                clearInterval(me.interval);
                if($($dom.find('.mask_txt')).html()!='已结束'){
                    me.interval=setInterval(setState,1000);
                }
                function setState(){
                    var Time=getTime(),startTime=$dom.attr('data-startTime').replace('：', ':'),endTime=$dom.attr('data-endTime').replace('：', ':');
                    // console.log(Time+';startTime:'+startTime+';endTime:'+endTime);
                    if(Time>=startTime&&Time<=endTime&&$($dom.find('.mask_txt')).html()!='进行中'){
                        // clearInterval(Interval);
                        $($dom.find('.mask_txt')).html(startTime+'<br>进行中');
                        $($dom.find('#hotelmask')).attr('class','jinxing');
                        $($dom.find('.xiangqing')).removeClass('disable').addClass('look').html('立即秒杀');
                        // $($dom.find('.qi>img')).attr('src','http://source.qunar.com/site/images/wap/touch/images/v2/images1x/yiyuanqi.png');
                        $($dom.find('.yuan_div')).removeClass('miaosha_disable')
                    }else if(Time>endTime&&$($dom.find('.mask_txt')).html()!='已结束'){
                        me.end();

                    }else if(Time<startTime){
                        $($dom.find('.mask_txt')).html(startTime+'<br>开&nbsp;抢');
                        $($dom.find('#hotelmask')).attr('class','kaimiao');
                        $($dom.find('.xiangqing')).addClass('disable').removeClass('look').html('即将开始');
                        // $($dom.find('.qi>img')).attr('src','http://source.qunar.com/site/images/wap/touch/images/v2/images1x/yiyuanqi.png');
                        $($dom.find('.yuan_div')).removeClass('miaosha_disable')
                    }
                }
            },
            stopInterval:function(){
                clearInterval(this.interval);
            },
            end:function(){
                var me=this,$dom=this.$dom;
                $($dom.find('.mask_txt')).html('已结束');
                $($dom.find('#hotelmask')).attr('class','jieshu');
                $($dom.find('.xiangqing')).removeClass('disable').addClass('look').html('查看其他房型');
                $($dom.find('.yuan_div')).addClass('miaosha_disable');
                setTimeout(function(){
                    me.$list.append($dom);
                },1);
                clearInterval(me.interval);
            },
            setEnd:function(){
                var me=this,$dom=this.$dom;
                var Time=getTime(),startTime=$dom.attr('data-startTime').replace('：', ':');
                if(Time>startTime){
                    me.end();
                }

            },
            setStart:function(price){
                var $dom=this.$dom;
                this.init(price);
                this.$list.prepend($dom);

            }
        }

        // 点击 高星酒店按钮 和 秒杀区的酒店图片
        $('.main').on('click','.hotel2_watch_div, .list_hotel_gaoxing, .hotel_img',function(){
            gotoDetail(this, false);
        });

        // 点击68元区 酒店按钮 和 酒店图片
        $('.main').on('click','.list_hotel_watch_div, .list_hotel_68',function(){
            gotoDetail(this, 4);
        });

        // 点击秒杀页酒店按钮
        $('.main').on('click','.xiangqing',function(e){
            var $me = $(this),
                seq = $me.data('seq');
            if($me.hasClass('disable')) {
                return;
            }
            if($me.hasClass('wantFollow')) { // 我要关注
                followHotelAjax(1, seq, $me);
                return;
            }
            if($me.hasClass('cancelFollow')) { // 取消关注
                followHotelAjax(2, seq, $me);
                return;
            }
            gotoDetail(this, 3);
        });

        function followHotelAjax(type, seq, $dom) {
            $.ajax({
                url: 'http://tchotel24.beta.qunar.com/h5/hotel/activity/SecKillV2FollowHotel',
                data: {
                    type: type,
                    seq: seq,
                    uparam: uParam,
                    pid: pid,
                    vid: vid
                },
                dataType: 'JSON',

                success: function(res) {
                    if(!res) return;
                    var isSuccess = JSON.parse(res).isSuccessful;
                    switch(type) {
                        case 1: // 我要关注
                            if(isSuccess) { // 关注成功
                                followSuccess(seq, $dom);
                            } else { // 关注失败
                                console.log('关注失败，请稍后再试');
                            }
                            break;
                        case 2: // 取消关注
                            if(isSuccess) { // 取消关注成功
                                cancelFollowSuccess(seq, $dom);
                            } else { // 取消关注失败
                                console.log('关注失败，请稍后再试');
                            }
                            break;
                    }
                },
                error: function(res) {
                    console.log('关注失败 ', res);
                }
            });
        }

        // 关注成功
        function followSuccess(seq, $dom) {
            $dom.removeClass('wantFollow').removeClass('operate').addClass('cancelFollow').html('取消关注');
            var cityUrl = $('.nav_table div.nav_active').attr('cityurl');

            window.localStorage[cityUrl] += (seq+',');

            var $hotelArea = $dom.closest('.hotel_area');
                if($('.miaosha_list').children().length > 1) {
                    $hotelArea.remove().insertBefore('.miaosha_list>div:first-child');
                }
        }

        // 取消关注成功
        function cancelFollowSuccess(seq, $dom) {
            $dom.removeClass('cancelFollow').addClass('wantFollow').addClass('operate').html('我要关注');
            var cityUrl = $('.nav_table div.nav_active').attr('cityurl');
            var seqStr = window.localStorage[cityUrl];
            if(seqStr) {
                if(seqStr.indexOf(seq) >= 0) {
                    window.localStorage[cityUrl] = seqStr.replace(seq+',', '');
                } else {
                    return;
                }
            }
        }

        function gotoDetail(dom, activityType){
            var $this=$(dom),
                avtiveName=$('.miaosha_tab .active').attr('name');
            var bd=bdSource+'_'+avtiveName,
                fromForLog=FromForLog[bd] || 112;
            if(!$this.hasClass('disable')){
                var seq=$this.attr('data-seq');
                var href='',scheme='';
                if(activityType){
                    scheme='hotel/detail?ids='+seq+'&needRoomVendor=0&activityType='+activityType+'&cat='+bd+'&fromForLog='+fromForLog+'&sourceType='+sourceType;
                }else{
                    scheme='hotel/detail?ids='+seq+'&needRoomVendor=0&cat='+bd+'&fromForLog='+fromForLog+'&sourceType='+sourceType;
                }
                ///////APPOUID///////
                scheme = scheme + '&appOuid=' + appOuid;
                /////////////////////
                href='://'+scheme;
                var url="";
                if(qua.iphonePro){
                    url="qunariphonepro" + href;
                }else if(qua.iphoneLife){
                    url="qunariphonelife" + href;
                }else if(qua.iphone){
                    url="qunariphone" + href;
                }else if(qua.androidLife){
                    url="qunaraphonelife" + href;
                }else if(qua.android){
                    url="qunaraphone" + href;
                }else{
                    var url1='hotel/hoteldetail?seq='+seq+'&bd_source='+bd+'&appOuid=' + appOuid;  ///APPOUID///
                    var touchUrl=encodeURIComponent(url1);
                    url = 'http://touch.qunar.com/h5/client?bd_source='+bd+'&sScheme=0&scheme='+encodeURIComponent(scheme)+'&touchUrl='+touchUrl;;
                }
                window.location.href =url;
            }
        }

        $('.main').on('click','.goto_zhongdianfang',function(){
            var cityName=$('.nav_active').html() || '北京',
                cityUrl='',
                avtiveName=$('.miaosha_tab .active').attr('name');
            var bd=bdSource+'_'+avtiveName,
                fromForLog=FromForLog[bd] || 112;
            $.ajax({
                url     : 'http://touch.qunar.com/h5/commonControl?action=getCityUrlByName',
                data    : {
                    cityName: cityName
                },
                dataType: 'json',
                success : function (data) {
                    cityUrl=data.cityUrl;
                    var href='hotel/search?cityUrl='+encodeURI(cityUrl)+'&cat='+bd+'&fromForLog='+fromForLog+'&sourceType='+sourceType;
                    var url="";
                    if(qua.iphonePro){
                        url="qunariphonepro://" + href;
                    }else if(qua.iphoneLife){
                        url="qunariphonelife://" + href;
                    }else if(qua.iphone){
                        url="qunariphone://" + href;
                    }else if(qua.androidLife){
                        url="qunaraphonelife://" + href;
                    }else if(qua.android){
                        url="qunaraphone://" + href;
                    }else{
                        var url1='hotel/hotellist?city='+encodeURI(cityName)+'&bd_source='+bd;
                        var scheme=encodeURIComponent(href);
                        var touchUrl=encodeURIComponent(url1);
                        var url ='http://touch.qunar.com/h5/client?bd_source='+bd+'&sScheme=0&scheme='+scheme+'&touchUrl='+touchUrl;
                        window.location.href=url;
                    }
                    window.location.href =url;
                },
                error   : function () {
                    console.log('网络错误，请稍后重试！');
                }
            })

        });

        function getTime(){
            var date=new Date();
            return fixZero(date.getHours())+":"+fixZero(date.getMinutes());

            function fixZero(num){
                if(num<10){return '0'+num;}
                return num;
            }
        }

        function getfromForLog(bdSource) {
            var bd_source= bdSource || 0;
            return 1000 + parseInt(bd_source.replace('huodong', '') || 0);
        }

        function getUrlParam(name){
            var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
            var r = decodeURIComponent(window.location.search.substr(1)).match(reg);  //匹配目标参数
            if (r!=null) return unescape(r[2]); return ''; //返回参数值
        }

        function lazy(){
            var p=0;
            var wSize=getWindowSize();
            var imgCollection = $('.miaosha_list img');
            $.each(imgCollection,function(index,item){
                p=item.getBoundingClientRect().top;
                if(p>=0&&p<wSize.pageHeight){
                    var $item= $(item);
                    $item.css({'opacity':'0'}).on('load',function(e){
                        $(this).addClass('img-fadeIn');
                    })
                    $item.attr('src',$(item).attr('lazy_src'));
                }
            })

        }

        function throttle(fn, delay) {
            var timer = null;
            return function () {
                var context = this, args = arguments;
                clearTimeout(timer);
                timer = setTimeout(function () {
                    fn.apply(context, args);
                }, delay);
            };
        }

        function getWindowSize(){
            var pageWidth = window.innerWidth;
            var pageHeight = window.innerHeight;
            if(typeof pageWidth !="number"){
                if(document.compatMode =="CSS1Compat"){
                    pageWidth = document.documentElement.clientWidth;
                    pageHeight = document.documentElement.clientHeight;
                }else{
                    pageWidth = document.body.clientWidth;
                    pageHeight = document.body.clientHeight;
                }
            }
            return {pageWidth:pageWidth,pageHeight:pageHeight};
        }

    });

    (function() {
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        var hm = document.createElement("script");
        hm.src = _bdhmProtocol + "hm.baidu.com/hm.js?98424ac1dde4320fb674fadfc53363c3";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</html>
