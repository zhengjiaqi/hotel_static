window.RedLayer=(function(){var b={huodong1:{bdSources:["ucpz1","sougoupz1","fanli_jd","baidupz1","3w"],img:"http://source.qunar.com/site/images/wap/touch/images/v2/images1x/qiang-red-icon.png",skipUrl:"http://touch.qunar.com/h5/red/secondversionvipred",period:30,localStorageKey:"touch_red_geted"}},a={huodong1:{bdSources:["ucpz1","sougoupz1","fanli_jd","baidupz1","3w"],img:"http://source.qunar.com/site/images/wap/touch/images/v2/images1x/qingdlb.png",skipUrl:"http://touch.qunar.com/h5/red/secondversionvipred",period:30,localStorageKey:"touch_red_showed"}};var f={style:".floatRed{width: 90px;height: 50px;position: fixed;top: 65%;right: 0;overflow: hidden;transition: all .5s; -webkit-transition: all .5s;}"+".floatRed_img{height: 100%;width: 90%;}"+".floatRed_hide{transform: translate3d(53px,0,0); -webkit-transform: translate3d(53px,0,0);opacity: .6;}",buildTpl:function(i,k){var h=b[i],j=e(h.skipUrl,{"bd_source":k});var g='<div class="floatRed " data-href="'+j+'">'+'<img class="floatRed_img" src="'+h.img+'">'+"</div>";$("body").append(g)},buildStyle:function(){var g=document.createElement("style");g.setAttribute("type","text/css");g.innerHTML=this.style;$("head").append(g)},buildEvents:function(){var h=this;var g=(function(){var j;return function(){clearTimeout(j);j=setTimeout(function(){h.show()},500)}})();var i=(function(){var j;return function(){clearTimeout(j);j=setTimeout(function(){h.hide()},4000)}})();$(".floatRed").on("click",function(){window.location.href=$(this).attr("data-href")});i();$(window).on("scroll",c(function(){h.show();i()},4000));$(window).on("scroll",function(){h.hide()})},show:function(){$(".floatRed").removeClass("floatRed_hide")},hide:function(){$(".floatRed").addClass("floatRed_hide")}};var d={style:".popUpRed_img{width: 100%;}"+".popUpRed{position: relative;}"+".popUpRed_close{position: absolute;width: 10%;height: 10%;top: 4%;right: 4%;}"+".popUpRed_get{position: absolute;width: 80%;height: 20%;bottom: 4%;right: 8%;}",buildTpl:function(i,k){var h=a[i],j=e(h.skipUrl,{"bd_source":k});var g='<div class="popUpRed"><img class="popUpRed_img" src="'+h.img+'"><div class="popUpRed_close"></div><div class="popUpRed_get"></div></div>';qt.showPopup({message:g,noHeader:true,noFooter:true,contentPadding:0,wrapBackground:"transparent",maskOpacity:0.8,events:{"tap .popUpRed_close":"redClose","tap .popUpRed_get":"redGet","tap .lo-close":"close"},onTapMask:function(){qt.hidePopup()},close:function(){qt.hidePopup()},redClose:function(l){qt.hidePopup()},redGet:function(){window.location.href=j;qt.hidePopup()}})},buildStyle:function(){var g=document.createElement("style");g.setAttribute("type","text/css");g.innerHTML=this.style;$("head").append(g)}};function c(h,g){var i=null;return function(){var k=this,j=arguments;clearTimeout(i);i=setTimeout(function(){h.apply(k,j)},g)}}function e(g,j){var k=g;for(var h in j){k=i(k,h,j[h])}return k;function i(m,l,n){var o=m.split("#")[0];if(/\?/g.test(o)){if(/name=[-\w]{4,25}/g.test(o)){o=o.replace(/name=[-\w]{4,25}/g,l+"="+n)}else{o+="&"+l+"="+n}}else{o+="?"+l+"="+n}if(m.split("#")[1]){o=o+"#"+m.split("#")[1]}else{o=o}return o}}return{buildFloatingLayer:function(i,l){l=l||"";var k,h=b[i];try{k=localStorage.getItem(h["localStorageKey"])}catch(j){}if(!h){return}if(h["bdSources"].indexOf(l)<0){return}if(k){var g=new Date().getTime();if(g-k>h["period"]*24*60*1000){try{localStorage.setItem(h["localStorageKey"],new Date().getTime())}catch(j){}}else{return}}f.buildStyle();f.buildTpl(i,l);f.buildEvents()},buildPopupLayer:function(i,l){l=l||"";var k,h=a[i];try{k=localStorage.getItem(h["localStorageKey"])}catch(j){}if(!h){return}if(h["bdSources"].indexOf(l)<0){return}if(k){var g=new Date().getTime();if(g-k>h["period"]*24*60*1000){try{localStorage.setItem(h["localStorageKey"],new Date().getTime())}catch(j){}}else{return}}else{try{localStorage.setItem(h["localStorageKey"],new Date().getTime())}catch(j){}}d.buildStyle();d.buildTpl(i,l)}}})();